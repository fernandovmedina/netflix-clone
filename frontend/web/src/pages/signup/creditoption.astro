---
import FooterSign from "../../components/Footer_sign.astro";
import NavbarSign from "../../components/Navbar_sign.astro";
import Layout from "../../layouts/Layout.astro";
---

<Layout title="Netflix">
    <main>
        <NavbarSign />

        <section class="w-full flex items-center justify-center">
            <div class="flex flex-col w-[35%] py-12">
                <div class="flex mb-4 items-center">
                    <img src="/behind_blue.png" alt="behind_blue_image" class="w-5">
                    <a id="chn" class="text-sm text-blue-500 hover:underline hover:underline-offset-1">Change payment method</a>
                </div>
                <h5 class="text-sm">STEP <span class="font-bold">4</span> OF <span class="font-bold">4</span></h5>
                <h1 class="mt-2 text-4xl font-bold">Configure your credit or debit card</h1>
                <div class="flex my-3">
                    <img src="/VISA.png" alt="payment_image">
                    <img src="/MASTERCARD.png" alt="payment_image">
                    <img src="/AMEX.png" alt="payment_image">
                    <img src="/CARNET.png" alt="payment_image">
                </div>
                <form action="" method="post">
                    <div class="flex border-2 border-gray-500 rounded px-3 py-2">
                        <input type="text" placeholder="Card number" required>
                        <div class="w-full flex justify-end">
                            <img src="/card.png" alt="card_image" class="w-7">
                        </div>
                    </div>
                    <div class="my-2 flex">
                        <input type="text" placeholder="Due date" required class="border-2 mr-1 border-gray-500 rounded px-3 py-2">
                        <div class="flex items-center border-2 border-gray-500 rounded px-3 py-2">
                            <input type="text" placeholder="CVV" required class="w-[50%]">
                            <div class="w-full flex justify-end">
                                <img src="/ayuda.png" alt="help_image" class="w-6">
                            </div>
                        </div>
                    </div>
                    <input type="text" placeholder="Name in the card" required class="w-full border-2 border-gray-500 rounded px-3 py-2">
                    <div class="bg-gray-200 p-3 flex my-2 rounded">
                        <div class="w-1/2">
                            <h1 class="font-bold text-base">$<span id="planPrice"></span> monthly</h1>
                            <h2 class="font-light" id="planName"></h2>
                        </div>
                        <div class="w-1/2 flex justify-end items-center">
                            <a id="change" class="text-blue-500 font-bold text-sm hover:underline hover:underline-offset-1">CHANGE</a>
                        </div>
                    </div>
                    <div class="my-2 text-xs text-gray-500">
                        <p>Payments will be processed internationally. Additional bank fees may apply.</p>
                        <br>
                        <p>By clicking the “Start Membership” button, you agree to our <a href="https://help.netflix.com/legal/termsofuse" class="text-blue-500 hover:underline hover:underline-offset-1">Terms of Use</a> and <a href="https://help.netflix.com/legal/privacy" class="text-blue-500 hover:underline hover:underline-offset-1">Privacy Statement</a> and represent that you are over 18 years of age. Additionally, you understand that Netflix will automatically continue your membership and, until you cancel, will bill you the monthly fee (currently $219 per month + applicable taxes) through your chosen payment method. You can cancel your membership at any time to avoid future charges. To cancel, go to Account and click “Cancel Membership.”</p>
                    </div>
                    <button id="smBTN" type="button" class="bg-red-600 hover:bg-red-700 w-full rounded text-white font-bold py-3 my-3">START MEMBERSHIP</button>
                    <p class="text-xs text-gray-500">This page is protected for Google reCAPTCHA to verify you are not a robot. <button type="button" class="text-blue-600 hover:underline hover:underline-offset-1" id="inf">More info</button></p>
                    <div class="hidden mt-2" id="hidden">
                        <p class="text-xs text-gray-500">The information collected by Google reCAPTCHA is subject to Google's <a class="text-blue-600 hover:underline hover:underline-offset-1" href="https://policies.google.com/privacy">Privacy Policy</a> and <a href="https://policies.google.com/terms" class="text-blue-600 hover:underline hover:underline-offset-1">Terms of Service</a>, and is used to provide, maintain and improve the reCAPTCHA service, as well as for general security purposes (Google does not use it to personalize advertising). ).</p>
                    </div>
                </form>
            </div>
        </section>

        <FooterSign />
    </main>

    <script>
        var inf = document.getElementById('inf');
        var hidden = document.getElementById('hidden');

        inf.addEventListener('click', () => {
            hidden.style.display = "block";
            inf.style.display = "none";
        });

        var change = document.getElementById("change");
        const email = new URLSearchParams(window.location.search).get("email");
        const password = new URLSearchParams(window.location.search).get("password");
        const plan = new URLSearchParams(window.location.search).get("plan");

        change.addEventListener('click', () => {
            window.location.href = `/signup/editplan?email=${email}&password=${password}&plan=${plan}`;
        });

        var smBTN = document.getElementById("smBTN");

        smBTN.addEventListener('click', () => {
            window.location.href = "/createProfile"
        });

        document.getElementById("chn").addEventListener('click', () => {
            window.location.href = `/signup/paymentPicker?email=${email}&password=${password}&plan=${plan}`;
        });

        var plans = {
            premium: {
                name: "Premium",
                price: "299",
            },
            standard: {
                name: "Standard",
                price: "219",
            },
            ads: {
                name: "Standard with ads",
                price: "99",
            }
        }

        var planName = document.getElementById("planName");
        var planPrice = document.getElementById("planPrice");

        if(plan === "premium") {
            planName.innerHTML = plans.premium.name;
            planPrice.innerHTML = plans.premium.price;
        } else if(plan === "standard") {
            planName.innerHTML = plans.standard.name;
            planPrice.innerHTML = plans.standard.price;
        } else {
            planName.innerHTML = plans.ads.name;
            planPrice.innerHTML = plans.ads.price;
        }
    </script>
</Layout>
